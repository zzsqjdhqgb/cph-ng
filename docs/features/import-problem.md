# 导入题目

从原始 CPH 扩展格式导入题目。

## 概述

导入题目功能允许您将题目从原始 CPH（Competitive Programming
Helper）扩展迁移到 CPH-NG。它读取与源代码关联的 CPH 题目文件，并将其转换为 CPH-NG 格式，包括所有测试用例和元数据。

## 用户交互

### 触发功能

**方法 1：侧边栏按钮**

- 打开具有关联 CPH 题目文件的源文件
- 点击 CPH-NG 侧边栏面板中的 `导入` 按钮
- 该按钮仅在检测到 CPH 题目数据时出现

**方法 2：命令面板**

- 按 `Ctrl+Shift+P`（Windows/Linux）或 `Cmd+Shift+P`（macOS）
- 输入并选择：`CPH-NG: Import Problem`

### 前置条件

- 编辑器中必须有活动的源文件
- 该源文件必须存在 CPH 题目文件（`.prob`）
- 该文件不应该已存在 CPH-NG 题目
- CPH 题目文件必须是有效格式

### UI 组件

导入选项显示为：

- 创建题目视图中带有输入图标的 `导入` 按钮
- 仅在检测到当前文件的 CPH 数据时显示
- 样式为包含（填充）按钮以吸引注意力

## 内部操作

### 工作原理

1. **检测**：检查活动源文件是否存在 CPH 题目文件
2. **验证**：
    - 验证 CPH-NG 题目不存在
    - 检查源文件路径是否有效
3. **加载**：读取并解析 CPH 题目文件
4. **转换**：将 CPH 数据格式转换为 CPH-NG 格式：
    - 题目名称和元数据
    - 时间和内存限制
    - 测试用例（输入和预期输出）
    - 题目 URL（如果可用）
5. **存储**：以 CPH-NG 格式保存转换后的题目
6. **UI 更新**：刷新侧边栏以显示导入的题目

### CPH 文件位置

CPH 将题目数据存储在 `.cph`
文件夹中，文件名基于源文件。CPH-NG 在检查导入可用性时会自动定位这些文件。

## 配置选项

### 相关设置

#### `cph-ng.problem.problemFilePath`

- **类型**：`string`
- **默认值**：`"${workspace}/.cph-ng/${relativeDirname}/${basename}.bin"`
- **说明**：导入的题目以 CPH-NG 格式存储的位置
- **注意**：导入的题目在转换后保存到此位置

## 错误处理

### 常见错误

**没有活动编辑器**

- **原因**：当前没有打开文件
- **消息**："未找到活动编辑器。请打开文件以创建题目。"
- **解决方案**：打开源文件并重试

**题目已存在**

- **原因**：该文件已存在 CPH-NG 题目
- **消息**："该文件已存在题目"
- **解决方案**：先删除现有的 CPH-NG 题目或使用其他文件

**未找到 CPH 数据**

- **原因**：源文件不存在 CPH 题目文件
- **消息**：导入按钮隐藏
- **解决方案**：改用创建题目，或确保 CPH 数据存在

**无效的 CPH 文件**

- **原因**：CPH 文件损坏或格式错误
- **消息**：导入静默失败或显示错误
- **解决方案**：检查 CPH 文件完整性或从头开始重新创建

## 工作流程示例

### 从 CPH 迁移

1. 打开具有 CPH 题目数据的文件（例如 `solution.cpp`）
2. CPH-NG 检测到 `.cph/solution.cpp.prob` 文件
3. 侧边栏中出现 `导入` 按钮
4. 点击 `导入` 按钮
5. CPH-NG 转换并导入：
    - 题目元数据
    - 所有测试用例
    - 时间/内存限制
6. 侧边栏更新以显示导入的题目
7. 测试用例立即可用于运行

### 导入后

- 原始 CPH 文件保持不变
- 题目现在为 CPH-NG 格式
- 可以对导入的题目使用所有 CPH-NG 功能
- 测试用例保持其数据（输入/输出）

## 相关功能

- [创建题目](create-problem.md) - 如果没有 CPH 数据的替代方案
- [编辑题目](edit-problem.md) - 修改导入的题目元数据
- [CPH 导入](cph-import.md) - 使用命令从 CPH 批量导入
